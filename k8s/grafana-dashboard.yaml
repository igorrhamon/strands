apiVersion: v1
kind: ConfigMap
metadata:
  name: strands-dashboard
  namespace: strands
data:
  strands-dashboard.json: |
    {
      "dashboard": {
        "title": "Strands Agent System",
        "panels": [
          {
            "title": "Agent Execution Duration (p95)",
            "targets": [
              {
                "expr": "histogram_quantile(0.95, sum(rate(strands_agent_execution_seconds_bucket[5m])) by (le, agent_name))",
                "legendFormat": "{{agent_name}}"
              }
            ],
            "type": "graph",
            "gridPos": { "h": 8, "w": 12, "x": 0, "y": 0 }
          },
          {
            "title": "Agent Success Rate",
            "targets": [
              {
                "expr": "sum(rate(strands_agent_executions_total{status='success'}[5m])) by (agent_name) / sum(rate(strands_agent_executions_total[5m])) by (agent_name)",
                "legendFormat": "{{agent_name}}"
              }
            ],
            "type": "graph",
            "gridPos": { "h": 8, "w": 12, "x": 12, "y": 0 }
          },
          {
            "title": "Orchestrator Queue Depth",
            "targets": [
              {
                "expr": "strands_orchestrator_queue_depth"
              }
            ],
            "type": "stat",
            "gridPos": { "h": 4, "w": 6, "x": 0, "y": 8 }
          },
          {
            "title": "Active Tasks",
            "targets": [
              {
                "expr": "strands_orchestrator_active_tasks"
              }
            ],
            "type": "stat",
            "gridPos": { "h": 4, "w": 6, "x": 6, "y": 8 }
          },
          {
            "title": "Decision Confidence Distribution",
            "targets": [
              {
                "expr": "histogram_quantile(0.95, sum(rate(strands_decision_confidence_bucket[5m])) by (le))"
              }
            ],
            "type": "heatmap",
            "gridPos": { "h": 8, "w": 12, "x": 12, "y": 8 }
          },
          {
            "title": "DB Connection Pool Size",
            "targets": [
              {
                "expr": "strands_db_pool_size",
                "legendFormat": "{{database}}"
              }
            ],
            "type": "graph",
            "gridPos": { "h": 8, "w": 12, "x": 0, "y": 12 }
          },
          {
            "title": "API Request Rate",
            "targets": [
              {
                "expr": "rate(http_requests_total[5m])"
              }
            ],
            "type": "graph",
            "gridPos": { "h": 8, "w": 12, "x": 12, "y": 12 }
          }
        ],
        "refresh": "5s"
      }
    }
